<!DOCTYPE html><html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ghi chÃº xÆ°á»Ÿng sáº£n xuáº¥t</title>
<style>
body{font-family:Arial,Helvetica,sans-serif;margin:0;background:#f4f4f4}
header{background:#222;color:#fff;padding:10px;display:flex;flex-wrap:wrap;gap:6px;align-items:center}
header button{padding:8px 12px;border:none;border-radius:6px;font-weight:bold;cursor:pointer}
header input{flex:1;padding:8px;border-radius:6px;border:none}
nav button{background:#555;color:#fff}
nav button.active{background:#2196F3}
section{display:none;padding:10px}
section.active{display:block}
.box{background:#fff;padding:10px;border-radius:8px;margin-bottom:10px}
label{font-weight:bold}
select,input[type=text],textarea{width:100%;padding:6px;margin:4px 0 8px 0}
textarea{min-height:80px}
.list-item{border-bottom:1px solid #ddd;padding:6px 0}
.list-item:last-child{border-bottom:none}
.small{font-size:13px;color:#555}
.actions button{margin-right:5px}
.danger{background:#f44336;color:#fff}
.save{background:#4CAF50;color:#fff}
.edit{background:#FF9800;color:#fff}
</style>
</head>
<body>
<header>
  <nav>
    <button onclick="showTab('machine')" class="active">MÃ¡y & HÃ ng</button>
    <button onclick="showTab('day')">Ca ngÃ y</button>
    <button onclick="showTab('night')">Ca Ä‘Ãªm</button>
  </nav>
  <input type="text" placeholder="ğŸ” TÃ¬m kiáº¿m toÃ n bá»™..." oninput="searchAll(this.value)">
  <button onclick="exportData()">Sao lÆ°u</button>
  <button onclick="importFile.click()">KhÃ´i phá»¥c</button>
  <button class="danger" onclick="resetAll()">Reset</button>
  <input type="file" id="importFile" accept=".json" hidden onchange="importData(this.files[0])">
</header><section id="machine" class="active">
  <div class="box">
    <label>Chá»n mÃ¡y</label>
    <select id="machineSelect" onchange="renderProducts()"></select>
    <button onclick="addProduct()">â• ThÃªm loáº¡i hÃ ng</button>
  </div>
  <div id="productList"></div>
</section><section id="day">
  <div class="box">
    <label>Ghi chÃº ca ngÃ y</label>
    <textarea id="dayNote"></textarea>
    <button class="save" onclick="saveShift('day')">LÆ°u</button>
    <button class="danger" onclick="clearShift('day')">XÃ³a</button>
  </div>
</section><section id="night">
  <div class="box">
    <label>Ghi chÃº ca Ä‘Ãªm</label>
    <textarea id="nightNote"></textarea>
    <button class="save" onclick="saveShift('night')">LÆ°u</button>
    <button class="danger" onclick="clearShift('night')">XÃ³a</button>
  </div>
</section><section id="searchResult"></section><script>
const MACHINES = ['1A','1B','2A','2B','3A','3B'];
let data = JSON.parse(localStorage.getItem('factoryData')) || {
  machines:{}, dayNote:'', nightNote:''
};
MACHINES.forEach(m=>data.machines[m]=data.machines[m]||[]);

function save(){localStorage.setItem('factoryData',JSON.stringify(data));}

function showTab(id){
  document.querySelectorAll('nav button').forEach(b=>b.classList.remove('active'));
  document.querySelectorAll('section').forEach(s=>s.classList.remove('active'));
  document.querySelector(`nav button[onclick*=${id}]`).classList.add('active');
  document.getElementById(id).classList.add('active');
}

function init(){
  const sel=document.getElementById('machineSelect');
  MACHINES.forEach(m=>sel.innerHTML+=`<option>${m}</option>`);
  document.getElementById('dayNote').value=data.dayNote;
  document.getElementById('nightNote').value=data.nightNote;
  renderProducts();
}

function renderProducts(){
  const m=document.getElementById('machineSelect').value;
  const list=document.getElementById('productList');
  list.innerHTML='';
  data.machines[m].forEach((p,i)=>{
    list.innerHTML+=`<div class="box list-item">
      <b>${p.name}</b> <span class="small">(${p.length})</span>
      <div class="small">Chuáº©n bá»‹: ${p.prepare}</div>
      <div class="small">LÆ°u Ã½: ${p.note}</div>
      <div class="actions">
        <button class="edit" onclick="editProduct('${m}',${i})">Sá»­a</button>
        <button class="danger" onclick="deleteProduct('${m}',${i})">XÃ³a</button>
      </div>
    </div>`;
  });
}

function addProduct(){
  const m=machineSelect.value;
  const name=prompt('TÃªn loáº¡i hÃ ng'); if(!name) return;
  const length=prompt('Chiá»u dÃ i');
  const prepare=prompt('Chuáº©n bá»‹');
  const note=prompt('LÆ°u Ã½');
  data.machines[m].push({name,length,prepare,note});
  save(); renderProducts();
}

function editProduct(m,i){
  const p=data.machines[m][i];
  p.name=prompt('TÃªn loáº¡i hÃ ng',p.name)||p.name;
  p.length=prompt('Chiá»u dÃ i',p.length)||p.length;
  p.prepare=prompt('Chuáº©n bá»‹',p.prepare)||p.prepare;
  p.note=prompt('LÆ°u Ã½',p.note)||p.note;
  save(); renderProducts();
}

function deleteProduct(m,i){
  if(confirm('XÃ³a loáº¡i hÃ ng nÃ y?')){
    data.machines[m].splice(i,1); save(); renderProducts();
  }
}

function saveShift(t){
  data[t+'Note']=document.getElementById(t+'Note').value; save();
}
function clearShift(t){
  if(confirm('XÃ³a ghi chÃº?')){data[t+'Note']='';document.getElementById(t+'Note').value='';save();}
}

function exportData(){
  const blob=new Blob([JSON.stringify(data,null,2)],{type:'application/json'});
  const a=document.createElement('a');
  a.href=URL.createObjectURL(blob);
  a.download='ghi-chu-xuong.json'; a.click();
}

function importData(file){
  const r=new FileReader();
  r.onload=()=>{ if(confirm('Ghi Ä‘Ã¨ toÃ n bá»™ dá»¯ liá»‡u?')){
    data=JSON.parse(r.result); save(); location.reload(); }};
  r.readAsText(file);
}

function resetAll(){ if(confirm('XÃ³a Táº¤T Cáº¢ dá»¯ liá»‡u?')){localStorage.removeItem('factoryData');location.reload();}}

function searchAll(q){
  q=q.toLowerCase(); const res=document.getElementById('searchResult');
  if(!q){res.innerHTML='';return;}
  res.classList.add('active'); res.innerHTML='';
  for(const m in data.machines){data.machines[m].forEach(p=>{
    const text=(m+p.name+p.length+p.prepare+p.note).toLowerCase();
    if(text.includes(q))res.innerHTML+=`<div class="box">ğŸ“Œ [${m}] ${p.name} â€“ ${p.length}</div>`;
  });}
  if(data.dayNote.toLowerCase().includes(q))res.innerHTML+=`<div class="box">â˜€ï¸ Ca ngÃ y</div>`;
  if(data.nightNote.toLowerCase().includes(q))res.innerHTML+=`<div class="box">ğŸŒ™ Ca Ä‘Ãªm</div>`;
}

init();
</script></body>
</html>
